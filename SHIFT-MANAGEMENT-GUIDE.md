# 🕐 دليل إدارة الشيفتات

## نظام إدارة الشيفتات للأدمن - Popup Card

### المميزات الجديدة:

#### 1️⃣ **للأدمن فقط:**
- ✅ زر "إدارة الشيفتات" في صفحة التقارير
- ✅ **Popup Card جميل** يعرض جميع الكاشيرات وحالة شيفتاتهم
- ✅ إمكانية بدء/إنهاء شيفت لأي كاشير
- ✅ عرض مبيعات كل كاشير في الشيفت الحالي
- ✅ تصميم مودرن مع كروت تفاعلية
- ✅ عرض مدة الشيفت بالدقائق

#### 2️⃣ **للكاشيرات:**
- ⚠️ لا يمكن الدخول لنظام الكاشير إلا إذا كان الشيفت نشط
- ⚠️ يجب على المدير بدء الشيفت أولاً
- ✅ رسالة واضحة إذا كان الشيفت غير نشط

---

## كيفية الاستخدام:

### للمدير (Admin):

1. **فتح نافذة إدارة الشيفتات:**
   - اذهب إلى `reports.html`
   - اضغط على زر "إدارة الشيفتات" في الأعلى
   - سيظهر **Popup Card** جميل بكل الكاشيرات

2. **بدء شيفت لكاشير:**
   - في الـ Card الخاص بالكاشير، اضغط "بدء الشيفت"
   - أكد العملية
   - سيتم تحديث الـ Card تلقائياً
   - الآن الكاشير يمكنه الدخول للنظام

3. **إنهاء شيفت:**
   - اضغط على زر "إنهاء الشيفت" في الـ Card
   - سيظهر ملخص المبيعات والطلبات
   - أكد الإنهاء
   - سيتم حفظ سجل الشيفت تلقائياً

4. **معلومات الـ Card:**
   - **Avatar** بأول حرف من اسم الكاشير
   - **حالة الشيفت** (نشط 🟢 / مغلق 🔴)
   - **وقت البدء** والتاريخ
   - **مدة الشيفت** بالدقائق (للشيفتات النشطة)
   - **إجمالي المبيعات** في الشيفت
   - **عدد الطلبات**

---

## البيانات المحفوظة:

### في localStorage:

```javascript
// حالة الشيفتات الحالية
userShifts: {
  "cashier1": {
    active: true,
    startTime: "2024-01-01T09:00:00",
    startedBy: "Admin"
  }
}

// سجل الشيفتات المغلقة
closedShifts: [
  {
    username: "cashier1",
    cashierName: "أحمد محمد",
    startTime: "2024-01-01T09:00:00",
    endTime: "2024-01-01T17:00:00",
    totalSales: 1500.00,
    totalOrders: 45,
    closedBy: "Admin",
    sales: [...]
  }
]
```

---

## الحماية والأمان:

- ✅ فقط المدير يمكنه إدارة الشيفتات
- ✅ الكاشير لا يمكنه بدء/إنهاء شيفته بنفسه
- ✅ التحقق من الصلاحيات في كل عملية
- ✅ حفظ سجل كامل لكل شيفت
- ✅ منع الكاشير من العمل بدون شيفت نشط

---

## ملاحظات مهمة:

1. **الشيفت يجب أن يكون نشط** قبل أن يتمكن الكاشير من الدخول
2. **سجل الشيفتات محفوظ** ويمكن الرجوع إليه في أي وقت
3. **المبيعات مرتبطة بالشيفت** - يتم حساب مبيعات كل شيفت بدقة
4. **المدير يمكنه العمل** بدون شيفت (صلاحيات كاملة)

---

## الأسئلة الشائعة:

**س: ماذا يحدث إذا حاول الكاشير الدخول بدون شيفت نشط؟**
ج: سيظهر له تنبيه ويُطلب منه التواصل مع المدير

**س: هل يمكن للكاشير رؤية شيفتات الآخرين؟**
ج: لا، فقط المدير يمكنه رؤية وإدارة جميع الشيفتات

**س: أين يتم حفظ سجلات الشيفتات؟**
ج: في localStorage تحت مفتاح `closedShifts`

**س: هل يمكن استرجاع بيانات شيفت قديم؟**
ج: نعم، جميع الشيفتات المغلقة محفوظة مع تفاصيل المبيعات
